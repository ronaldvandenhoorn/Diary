<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Diary 2026</title>
    <style>
        :root {
            color-scheme: light dark;
            --bg: #f8f8fa; --bg-section: #ffffff; --bg-entry: #eaf3ff;
            --text: #222222; --muted: #555555; --accent: #2a7ae2;
            --shadow: #00000011; --border-soft: #d0d7e2;
        }
        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a; --bg-section: #111827; --bg-entry: #1e293b;
                --text: #e5e7eb; --muted: #9ca3af; --accent: #60a5fa;
                --shadow: #00000066; --border-soft: #374151;
            }
        }
        body { font-family: Arial, sans-serif; margin: 0; background: var(--bg); color: var(--text); padding-bottom: 50px; }
        #lockScreen { position: fixed; inset: 0; background: radial-gradient(circle at top, #1d4ed8 0, #020617 55%); color: #e5e7eb; display: flex; align-items: center; justify-content: center; z-index: 1000; }
        #lockInner { width: 90%; max-width: 360px; background: rgba(15, 23, 42, 0.9); border-radius: 18px; padding: 1.5rem; border: 1px solid rgba(148, 163, 184, 0.5); }
        #pinInput { width: 100%; font-size: 1.4rem; padding: 0.6rem; text-align: center; border-radius: 10px; border: 1px solid #4b5563; background: #020617; color: #e5e7eb; margin-bottom: 10px; }
        #app { display: none; }
        .container { max-width: 500px; margin: 0 auto; padding: 1em; }
        .section { background: var(--bg-section); border-radius: 10px; padding: 1.2em; margin-bottom: 1.2em; box-shadow: 0 2px 10px var(--shadow); border: 1px solid var(--border-soft); }
        h2 { color: var(--accent); margin-top: 0; font-family: Georgia, serif; font-size: 1.3rem; border-bottom: 1px solid var(--border-soft); padding-bottom: 5px; }
        h3 { font-size: 0.9rem; color: var(--muted); text-transform: uppercase; margin-top: 15px; margin-bottom: 5px; }
        label { display: block; margin: 8px 0; font-size: 0.95rem; }
        textarea, input[type="text"] { width: 100%; padding: 0.6em; border-radius: 6px; border: 1px solid var(--border-soft); background: var(--bg); color: var(--text); box-sizing: border-box; margin-bottom: 10px; }
        button { background: var(--accent); color: #fff; border: none; padding: 1em; border-radius: 8px; font-size: 1.1em; cursor: pointer; width: 100%; margin-top: 10px; }
        .btn-export { background: transparent; border: 2px solid var(--accent); color: var(--accent); margin-top: 2em; }
        .entry { background: var(--bg-entry); border-radius: 6px; padding: 0.7em; margin-bottom: 1em; border: 1px solid var(--border-soft); font-size: 0.9rem; }
        .mood-options { display: flex; justify-content: space-around; font-size: 1.8rem; margin: 10px 0; }
        .mood-option { cursor: pointer; opacity: 0.3; transition: 0.2s; }
        .mood-option.selected { opacity: 1; transform: scale(1.2); }
    </style>
</head>
<body>

<div id="lockScreen">
    <div id="lockInner">
        <h1 style="text-align:center;">My Diary</h1>
        <div id="lockModeLabel" style="text-align:center; margin-bottom:10px;">Enter PIN</div>
        <input id="pinInput" type="password" maxlength="4" inputmode="numeric">
        <button id="btnConfirmPin">Unlock</button>
        <button id="btnResetPin" style="background:none; border:1px solid #444; margin-top:5px; font-size:0.8rem;">Reset PIN</button>
    </div>
</div>

<div id="app">
    <div class="container">
        <div id="todayDate" style="text-align:center; font-weight:bold;"></div>
        <div id="quote" style="text-align:center; font-style:italic; margin: 15px 0;"></div>

        <form id="diaryForm">
            <!-- COMMITMENTS -->
            <div class="section">
                <h2>Commitments</h2>
                <h3>Communication</h3>
                <label><input type="checkbox" name="comm_listen"> Understand -> Did I Listen?</label>
                <label><input type="checkbox" name="comm_assert"> Be understood -> Did I Assert?</label>
                <label><input type="checkbox" name="comm_road"> No roadblocks or 5C‚Äôs</label>
                <h3>Action & Collaboration</h3>
                <label><input type="checkbox" name="act_space"> Did I use the space?</label>
                <label><input type="checkbox" name="act_assume"> I did not assume</label>
                <label><input type="checkbox" name="collab"> Relations & Agreements</label>
                <h3>Leadership</h3>
                <label><input type="checkbox" name="lead_ex"> By example</label>
                <label><input type="checkbox" name="lead_help"> By helping</label>
            </div>

            <!-- VALUES -->
            <div class="section">
                <h2>Values</h2>
                <label><input type="checkbox" name="v1"> Fearlessness & Respect</label>
                <label><input type="checkbox" name="v2"> Gratitude & Sincerity</label>
                <label><input type="checkbox" name="v3"> Humility & Trustworthiness</label>
                <label><input type="checkbox" name="v4"> Love & Hope</label>
                <label><input type="checkbox" name="v5"> Perform & Produce</label>
            </div>

            <!-- FITNESS -->
            <div class="section">
                <h2>Fitness</h2>
                <label>Body</label><input type="text" name="fit_body">
                <label>Mind</label><input type="text" name="fit_mind">
                <label>Heart</label><input type="text" name="fit_heart">
                <label>Soul</label><input type="text" name="fit_soul">
            </div>

            <!-- MOOD -->
            <div class="section">
                <h2>Mood</h2>
                <div class="mood-options">
                    <span class="mood-option" onclick="setMood('üòÑ', this)">üòÑ</span>
                    <span class="mood-option" onclick="setMood('üôÇ', this)">üôÇ</span>
                    <span class="mood-option" onclick="setMood('üòê', this)">üòê</span>
                    <span class="mood-option" onclick="setMood('üôÅ', this)">üôÅ</span>
                    <span class="mood-option" onclick="setMood('üò¢', this)">üò¢</span>
                </div>
                <input type="hidden" name="mood" id="moodInput">
            </div>

            <!-- EFFECTIVENESS / GRATITUDE -->
            <div class="section">
                <h2>Effectiveness</h2>
                <label>Gratitude 1</label><input type="text" name="grat1">
                <label>Gratitude 2</label><input type="text" name="grat2">
                <label>Gratitude 3</label><input type="text" name="grat3">
                <label>Kindness</label><textarea name="kindness" rows="2"></textarea>
                <label>Goals</label><textarea name="goals" rows="2"></textarea>
            </div>

            <div class="section">
                <h2>Reflection</h2>
                <textarea name="diaryEntry" rows="4"></textarea>
            </div>

            <button type="submit">Save Entry</button>
        </form>

        <div class="history">
            <h2>History</h2>
            <div id="entries"></div>
            <button type="button" class="btn-export" onclick="exportToTextFile()">Save Diary to .txt File</button>
        </div>
    </div>
</div>

<script>
    const PIN_KEY = "diaryPin_v3";
    const ENTRIES_KEY = "diaryEntries_v3";

    function initLock() {
        const stored = localStorage.getItem(PIN_KEY);
        document.getElementById("btnConfirmPin").onclick = () => {
            const entered = document.getElementById("pinInput").value;
            if (!stored) { localStorage.setItem(PIN_KEY, entered); unlock(); }
            else if (entered === stored) { unlock(); }
            else { alert("Wrong PIN"); }
        };
        document.getElementById("btnResetPin").onclick = () => { if(confirm("Reset PIN?")) { localStorage.removeItem(PIN_KEY); location.reload(); } };
    }

    function unlock() { document.getElementById("lockScreen").style.display = "none"; document.getElementById("app").style.display = "block"; displayEntries(); }

    function setMood(val, el) { 
        document.getElementById("moodInput").value = val;
        document.querySelectorAll('.mood-option').forEach(o => o.classList.remove('selected'));
        el.classList.add('selected');
    }

    document.getElementById("diaryForm").onsubmit = (e) => {
        e.preventDefault();
        const fd = new FormData(e.target);
        const entry = {
            date: new Date().toLocaleString(),
            mood: fd.get('mood'),
            grat: [fd.get('grat1'), fd.get('grat2'), fd.get('grat3')].filter(Boolean).join(' | '),
            text: fd.get('diaryEntry')
        };
        const entries = JSON.parse(localStorage.getItem(ENTRIES_KEY) || "[]");
        entries.unshift(entry);
        localStorage.setItem(ENTRIES_KEY, JSON.stringify(entries));
        e.target.reset();
        displayEntries();
        alert("Saved!");
    };

    function displayEntries() {
        const entries = JSON.parse(localStorage.getItem(ENTRIES_KEY) || "[]");
        document.getElementById("entries").innerHTML = entries.map(e => `
            <div class="entry">
                <strong>${e.date} ${e.mood || ''}</strong><br>
                ${e.grat ? `<small>Grateful for: ${e.grat}</small><br>` : ''}
                ${e.text}
            </div>
        `).join('');
    }

    function exportToTextFile() {
        const entries = JSON.parse(localStorage.getItem(ENTRIES_KEY) || "[]");
        let content = "MY DIARY EXPORT\n\n";
        entries.forEach(e => { content += `${e.date}\nMood: ${e.mood}\nGratitude: ${e.grat}\nEntry: ${e.text}\n\n---\n\n`; });
        const blob = new Blob([content], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `diary_backup.txt`;
        link.click();
    }

    initLock();
    document.getElementById("todayDate").textContent = new Date().toDateString();
    const quotes = ["Seek, find, impact!", "Tough on results, gentle with people.", "Can do attitude!"];
    document.getElementById("quote").textContent = quotes[Math.floor(Math.random()*quotes.length)];
</script>
</body>
</html>
